#!/bin/bash

# –¢–µ—Å—Ç–æ–≤—ã–π –∏–º–ø–æ—Ä—Ç –∑–∞–¥–∞—á –∏–∑ —É—á–µ–±–Ω–∏–∫–∞ –∞–ª–≥–µ–±—Ä—ã

API_URL="http://127.0.0.1:8081"

# –¢–µ—Å—Ç–æ–≤—ã–π OCR —Ç–µ–∫—Å—Ç —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã —É—á–µ–±–Ω–∏–∫–∞ –∞–ª–≥–µ–±—Ä—ã 7 –∫–ª–∞—Å—Å–∞
TEST_TEXT='1. –†–µ—à–∏—Ç–µ —É—Ä–∞–≤–Ω–µ–Ω–∏–µ:
$3x + 5 = 20$

2. –ù–∞–π–¥–∏—Ç–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:
$\\frac{x^2 - 9}{x - 3}$ –ø—Ä–∏ $x = 4$

3. –£–ø—Ä–æ—Å—Ç–∏—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ:
$(a + b)^2 - (a - b)^2$

–¢–µ–æ—Ä–µ–º–∞ 1: –ö–≤–∞–¥—Ä–∞—Ç —Å—É–º–º—ã –¥–≤—É—Ö —á–∏—Å–µ–ª —Ä–∞–≤–µ–Ω –∫–≤–∞–¥—Ä–∞—Ç—É –ø–µ—Ä–≤–æ–≥–æ —á–∏—Å–ª–∞ –ø–ª—é—Å —É–¥–≤–æ–µ–Ω–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ —á–∏—Å–ª–∞ –Ω–∞ –≤—Ç–æ—Ä–æ–µ –ø–ª—é—Å –∫–≤–∞–¥—Ä–∞—Ç –≤—Ç–æ—Ä–æ–≥–æ —á–∏—Å–ª–∞.
$(a + b)^2 = a^2 + 2ab + b^2$

4. –†–µ—à–∏—Ç–µ —Å–∏—Å—Ç–µ–º—É —É—Ä–∞–≤–Ω–µ–Ω–∏–π:
$\\begin{cases} x + y = 5 \\\\ 2x - y = 1 \\end{cases}$

–û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: –£—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∏–¥–∞ $ax + b = 0$, –≥–¥–µ $a \\neq 0$, –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω—ã–º —É—Ä–∞–≤–Ω–µ–Ω–∏–µ–º —Å –æ–¥–Ω–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π.

5. –ù–∞–π–¥–∏—Ç–µ –∫–æ—Ä–µ–Ω—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è:
$2(x - 3) = 4x - 10$

–ó–∞–¥–∞—á–∞ 6: –ü–ª–æ—â–∞–¥—å –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Ä–∞–≤–Ω–∞ $48 \\text{ —Å–º}^2$. –ù–∞–π–¥–∏—Ç–µ —Å—Ç–æ—Ä–æ–Ω—ã –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞, –µ—Å–ª–∏ –æ–¥–Ω–∞ —Å—Ç–æ—Ä–æ–Ω–∞ –≤ 3 —Ä–∞–∑–∞ –±–æ–ª—å—à–µ –¥—Ä—É–≥–æ–π.

–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ 7: –í—ã—á–∏—Å–ª–∏—Ç–µ:
$\\sqrt{16} + \\sqrt{9} - \\sqrt{25}$'

echo "üöÄ –¢–µ—Å—Ç–∏—Ä—É–µ–º –∏–º–ø–æ—Ä—Ç OCR —Ç–µ–∫—Å—Ç–∞..."
echo ""

# –ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö
curl -s -X POST "${API_URL}/api/import" \
  -H "Content-Type: application/json" \
  -d "{
    \"book_id\": \"algebra-7\",
    \"chapter_num\": 1,
    \"chapter_title\": \"–õ–∏–Ω–µ–π–Ω—ã–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è\",
    \"text\": $(echo "$TEST_TEXT" | jq -Rs '.')
  }" | jq .

echo ""
echo "‚úÖ –ò–º–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω!"
echo ""
echo "üìä –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –≥–ª–∞–≤—ã..."
curl -s "${API_URL}/api/chapters/algebra-7:1/problems" | jq '. | length' | xargs echo "–ù–∞–π–¥–µ–Ω–æ –∑–∞–¥–∞—á:"

echo ""
echo "üìö –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ç–µ–æ—Ä–∏—é..."
curl -s "${API_URL}/api/chapters/algebra-7:1/theory" | jq '. | length' | xargs echo "–ù–∞–π–¥–µ–Ω–æ –±–ª–æ–∫–æ–≤ —Ç–µ–æ—Ä–∏–∏:"

echo ""
echo "üîó –ü—Ä–æ—Å–º–æ—Ç—Ä –≤ –±—Ä–∞—É–∑–µ—Ä–µ: ${API_URL}/textbook/chapter/algebra-7:1"
